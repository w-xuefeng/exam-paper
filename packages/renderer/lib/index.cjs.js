const e="question",t="answer",n="title",r="description",o="blank",l="header",a="footer",s="inline",i="css",c=()=>{};function u(e){return void 0===e&&(e=""),"number"==typeof e&&(e=String(e)),document.createTextNode(e)}function d(e,t,n){const r=e();return t&&Object.entries(t).forEach(([e,t])=>{if("attrs"===e&&"object"==typeof t&&null!==t)Object.entries(t).forEach(([e,t])=>{r.setAttribute(e,t)});else if("on"===e&&"object"==typeof t&&null!==t)Object.entries(t).forEach(([e,t])=>{const n="function"==typeof t?t.bind(r):"object"==typeof t&&null!==t&&"event"in t&&"function"==typeof t.event?t.event.bind(r):"object"==typeof t&&null!==t&&"handleEvent"in t&&"function"==typeof t.handleEvent?t.handleEvent.bind(r):()=>{},o="object"==typeof t&&null!==t&&"option"in t?t.option:void 0;r.addEventListener(e,n,o)});else if("style"===e)if("object"==typeof t&&null!==t){const e="string"!=typeof(a=t)&&a?Object.entries(a).map(([e,t])=>{return`${n=e,n.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^-/,"")}:${t}`;var n}).join(";"):a;Reflect.set(r.style,"cssText",e)}else"string"==typeof t&&Reflect.set(r.style,"cssText",t);else"className"===e?(n=r,o=r.tagName,l=t,p(o)||function(e){return"svg"===e?.dataset?.domType||"svg"===e?.tagName}(n)?Reflect.set(n.className,"baseVal",l):Reflect.set(n,"className",l)):"attrs"!==e&&"on"!==e&&"style"!==e&&Reflect.set(r,e,t);var n,o,l,a}),n&&r.append(...Array.isArray(n)?n:[n]),r}function p(e){return"string"==typeof e&&("svg"===e||e.startsWith("SVG:"))}function f(e,t,n){return d(p(e)?()=>{const t=document.createElementNS("http://www.w3.org/2000/svg",e.replace(/^SVG:/,""));return t.setAttribute("data-dom-type","svg"),t}:()=>document.createElement(e),t,n)}function E(e){if(!e)return null;if("string"==typeof e)return f("style",null,u(e));if(!Object.keys(e).length)return null;function t(e){let n="";if("string"==typeof e||"number"==typeof e||!e)return n;for(const[r,o]of Object.entries(e)){if("string"==typeof o||"number"==typeof o){n+=`${r.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${o};`}"object"==typeof o&&(n+=`${r} {${t(o)}}`)}return n.trim()}return f("style",null,u(function(e){let n="";for(const[r,o]of Object.entries(e))n+=`${r} {${t(o)}}`;return n.trim()}(e)))}function y(e,t=document.body){if(!e)return c;const n=function(e,t=document){return"string"==typeof e?t.querySelector(e):e}(t);if(!n)return c;n.append(e)}function m(e){if("remove"in e&&"function"==typeof e.remove)e.remove();else if(e&&e.parentNode)e.parentNode.removeChild(e);else if("outerHTML"in e)e.outerHTML="";else{if("#document-fragment"!==e.nodeName)throw new Error("[DOMily] removeDOM is not supported in this environment");e.childNodes.forEach(e=>m(e))}}function b(e){const{value:t}="value"in e?e:{value:e};return t}function h(e,t,n){customElements.get(e)||customElements.define(e,t,n)}const R=e=>`exam-paper-${e}`,T={PAPER:R("container"),QUESTION:R("question"),ANSWER:R("answer"),TITLE:R("title"),DESCRIPTION:R("description"),BLANK:R("blank"),HEADER:R("header"),FOOTER:R("footer"),STYLED:R("styled-content"),QUESTION_ORDER_NUMBER:R("question-order-number"),QUESTION_SCORE:R("question-score")};var v=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function O(e,t=T.STYLED,n){h(T.STYLED,v);const r=`${t}-${crypto.randomUUID()}`,{type:o,value:l}=e.style,a=o===s?l:void 0,c=o===i?E({[`.${r}`]:l}):null;if(c){const o=f(t,n);return function(e,t){const n=Array.isArray(t)?t:[t],r="string"==typeof e?document.querySelector(e):e;r&&n.forEach(e=>{r?.classList?.contains?.(e)||r?.classList?.add?.(e)})}(o,r),o.append(c),e.value&&o.append(f("main",{innerHTML:e.value})),o}return f(t,{...n,innerHTML:e.value,style:a})}var N=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function g(e){h(T.STYLED,N);const t=b(e);return"string"==typeof t?f(T.ANSWER,{innerHTML:t}):O(t,T.ANSWER)}var x=class extends HTMLElement{constructor(){super()}connectedCallback(){}},S=class extends HTMLElement{constructor(){super()}connectedCallback(){}},k=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function L(e){h(T.QUESTION,x),h(T.QUESTION_ORDER_NUMBER,S),h(T.QUESTION_SCORE,k);const{orderNumber:t,title:n,description:r,options:o,score:l,answer:a}=b(e),s=O(n),i=t?f(T.QUESTION_ORDER_NUMBER,{textContent:t}):null,c=l?f(T.QUESTION_SCORE,{textContent:l.formatter?l.formatter.replace("%d",`${l.value}`):`${l.value}`}):null,u=r?O(r):null,d=o?.map(e=>O(e)),p=a?g(a.value):null,E=[i,s,c].filter(Boolean),y=[i||c?f("header",{style:{display:"inline-flex",alignItems:"baseline",gap:"0.5em"}},E):s,u,d,p].filter(Boolean).flat();return f(T.QUESTION,null,y)}function A(e){const{value:t}=e,{type:n}=t;return L(t)}var C=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function I(e){h(T.TITLE,C);return O(b(e),T.TITLE)}var $=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function D(e){h(T.DESCRIPTION,$);return O(b(e),T.DESCRIPTION)}var H=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function M(e){return h(T.BLANK,H),O({value:"",style:e.style},T.BLANK)}var U=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function B(e,t=!1){h(T.HEADER,U);const n=b(e);return t?O({style:n.style,value:""},T.HEADER,{className:"header-placeholder"}):f("header",null,[O(n,T.HEADER),O(n,T.HEADER,{className:"print-header"})])}var w=class extends HTMLElement{constructor(){super()}connectedCallback(){}};function j(e,t=!1){h(T.FOOTER,w);const n=b(e);return t?O({style:n.style,value:""},T.FOOTER,{className:"footer-placeholder"}):f("footer",null,[O(n,T.FOOTER),O(n,T.FOOTER,{className:"print-footer"})])}function P({paper:e,direction:t,pagination:n}){const r=`${e} ${t}`,o=n?.position?{[`@${n.position}`]:{content:n.formatter?.replace("%current","counter(page)").replace("%total","counter(pages)"),...n.style?n.style:{}}}:{};return{[T.PAPER]:{display:"block"},[T.QUESTION]:{display:"block"},[T.ANSWER]:{display:"block"},[T.TITLE]:{display:"block"},[T.DESCRIPTION]:{display:"block"},[T.BLANK]:{display:"block"},[T.HEADER]:{display:"block"},[T.FOOTER]:{display:"block"},[T.STYLED]:{display:"block"},[T.QUESTION_ORDER_NUMBER]:{display:"block"},[T.QUESTION_SCORE]:{display:"block"},".exam-paper-table-layout":{width:"100%"},".print-header, .print-footer":{display:"none"},".header-placeholder,.footer-placeholder":{display:"none"},"@media print":{"@page":{size:r,boxSizing:"border-box",...o},[`${T.FOOTER}, ${T.HEADER}`]:{display:"none"},[`${T.HEADER}.print-header, ${T.FOOTER}.print-footer`]:{display:"block",position:"fixed",left:0,width:"100%",backgroundColor:"#ffffff",boxSizing:"border-box"},[`${T.HEADER}.print-header`]:{top:0,borderBlockEnd:"1px solid #ccc",paddingBlockEnd:"5px"},[`${T.FOOTER}.print-footer`]:{bottom:0,borderBlockStart:"1px solid #ccc",paddingBlockStart:"5px"},".header-placeholder,.footer-placeholder":{display:"block"},[T.QUESTION]:{breakInside:"avoid"},[T.TITLE]:{breakInside:"avoid"},[`body, ${T.PAPER}`]:{padding:"0!important",margin:"0!important"}}}}function Q(e,t=document){const n="exam-paper-element-agent-style-sheet",r=document.getElementById(n)||t.querySelector(`#${n}`);r&&m(r);const o=E(P(e));o&&function(e,t=`global-custome-style-${Date.now()}`,n=document){e.id=e.id||t,n===document?n.head.appendChild(e):n.insertBefore(e,n.firstChild)}(o,n,t)}var _=class extends HTMLElement{paper;direction;pagination;header;footer;table=null;tableMainContainer=null;layout=[];constructor(){super()}connectedCallback(){const e=Object.fromEntries(Array.from(this.attributes).map(e=>{return[e.name,(t=e.value,"null"===t?null:"'null'"===t||'"null"'===t?"null":"undefined"!==t?"'undefined'"===t||'"undefined"'===t?"undefined":"true"===t||("'true'"===t||'"true"'===t?"true":"false"!==t&&("'false'"===t||'"false"'===t?"false":/^\d+$/.test(t)?Number(t):t)):void 0)];var t}));"string"==typeof e.type&&e.type&&(this.paper=e.type),"string"==typeof e.direction&&e.direction&&(this.direction=e.direction);Q({paper:this.paper||"A4",direction:this.direction||"portrait",pagination:this.pagination},this),(this.header||this.footer)&&(this.tableMainContainer=f("td",null,this.layout),this.table=f("table",{className:"exam-paper-table-layout"},[this.header?f("thead",null,[f("tr",null,[f("td",null,B(this.header,!0))])]):null,f("tbody",null,[f("tr",null,this.tableMainContainer)]),this.footer?f("tfoot",null,[f("tr",null,[f("td",null,j(this.footer,!0))])]):null].filter(Boolean)),this.appendChild(this.table))}};function F(e){h(T.PAPER,_);const{paper:t,direction:n="portrait",pagination:r={style:{fontSize:"12px"},formatter:"第 %current 页 / 共 %total 页",position:"bottom-center"},value:{style:o,layout:{header:l,footer:a}}}=e;return O({value:"",style:o},T.PAPER,{header:l,footer:a,pagination:r,attrs:{paper:t,direction:n}})}function q(s){switch(s.type){case e:return A(s);case n:return I(s);case r:return D(s);case o:return M(s);case l:return B(s);case a:return j(s);case t:return g(s);default:return null}}exports.answerRenderer=g,exports.applyElementDefaultStyles=Q,exports.blankRenderer=M,exports.descriptionRenderer=D,exports.elementDefaultStyles=P,exports.examPaperRenderer=function(e){const{value:{layout:t}}=e,n=F(e),r=[],{header:o,title:l,description:a,main:s,answer:i,footer:c}=t;return o&&r.push(B(o)),l&&r.push(I(l)),a&&r.push(D(a)),s&&r.push(...s.map(q).filter(Boolean)),i&&r.push(...i.map(g)),c&&r.push(j(c)),n.header||n.footer?n.layout=r:n.append(...r),{paper:n,mounted:(e=document.body)=>{y(n,e)}}},exports.footerRenderer=j,exports.headerRenderer=B,exports.matchRender=q,exports.paperRenderer=F,exports.questionRenderer=A,exports.styledContentRenderer=O,exports.titleRenderer=I;